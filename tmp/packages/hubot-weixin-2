{"_id":"hubot-weixin-2","_rev":"8-74625148f4ba49dc9aa989dff7ee7116","name":"hubot-weixin-2","description":"This is wechat/weixin adapter for hubot","dist-tags":{"latest":"1.1.4"},"versions":{"1.0.8":{"name":"hubot-weixin-2","version":"1.0.8","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"400c70ac93a057fe0a299cbdfe3b39526868a7ba","_id":"hubot-weixin-2@1.0.8","scripts":{},"_shasum":"a70c12c45791b604b13f072347f60cfc50542833","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"a70c12c45791b604b13f072347f60cfc50542833","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.0.8.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.0.8.tgz_1477305431890_0.7480913426261395"}},"1.0.9":{"name":"hubot-weixin-2","version":"1.0.9","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"9c2df3a92784d1e2cc3023680931f140c0e09b68","_id":"hubot-weixin-2@1.0.9","scripts":{},"_shasum":"de2729afd9cb0d822e4ba116989117f42f001667","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"de2729afd9cb0d822e4ba116989117f42f001667","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.0.9.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.0.9.tgz_1477306610012_0.24502235790714622"}},"1.1.0":{"name":"hubot-weixin-2","version":"1.1.0","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"159a2c3e83dcc5f199ae78bcb36d04f2dd95d123","_id":"hubot-weixin-2@1.1.0","scripts":{},"_shasum":"d6c5ae4dae248584dfce2f955d1c3b49ef832cda","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"d6c5ae4dae248584dfce2f955d1c3b49ef832cda","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.1.0.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.1.0.tgz_1477307915569_0.046038797590881586"}},"1.1.1":{"name":"hubot-weixin-2","version":"1.1.1","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"14f9f6ebb8ff726c7716e1cde512976efd35d4c1","_id":"hubot-weixin-2@1.1.1","scripts":{},"_shasum":"ac6fb2f3c5406107fb2f91dfd6720ee01da8c358","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"ac6fb2f3c5406107fb2f91dfd6720ee01da8c358","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.1.1.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.1.1.tgz_1477308664739_0.5290568978525698"}},"1.1.2":{"name":"hubot-weixin-2","version":"1.1.2","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"97c5b4b4570f4ea38679b056768a295ad60f9772","_id":"hubot-weixin-2@1.1.2","scripts":{},"_shasum":"f3fe3556cdffb11d945be60c6aa80d25ff1a8476","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"f3fe3556cdffb11d945be60c6aa80d25ff1a8476","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.1.2.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.1.2.tgz_1477308893310_0.745022393297404"}},"1.1.3":{"name":"hubot-weixin-2","version":"1.1.3","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"700c737f21c25f15f17887ff52a5536a42452b02","_id":"hubot-weixin-2@1.1.3","scripts":{},"_shasum":"92489923922d11f9b958edc88b33420183081a1e","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"92489923922d11f9b958edc88b33420183081a1e","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.1.3.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.1.3.tgz_1477310589850_0.13812527409754694"}},"1.1.4":{"name":"hubot-weixin-2","version":"1.1.4","description":"This is wechat/weixin adapter for hubot","main":"./src/hubot-wx.coffee","keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","dependencies":{"js-yaml":">= 3.0.0","lodash":"^4.15.0","log":"1.4.0","parent-require":"^1.0.0","sync-request":"^2.1.0","nanotimer":"^0.3.14","file-md5":"1.0.0"},"devDependencies":{"coffee-script":">=1.2.0","coffeelint":"^1.14.1"},"gitHead":"0f8d9e297373489ad6e2f4aff3587845f625c19b","_id":"hubot-weixin-2@1.1.4","scripts":{},"_shasum":"3c66389f3ce57205881cdb7aa0fe3b6e3b40373d","_from":".","_npmVersion":"3.10.8","_nodeVersion":"6.8.1","_npmUser":{"name":"xxlv","email":"lvxiang119@gmail.com"},"dist":{"shasum":"3c66389f3ce57205881cdb7aa0fe3b6e3b40373d","tarball":"http://registry.npmjs.org/hubot-weixin-2/-/hubot-weixin-2-1.1.4.tgz"},"maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/hubot-weixin-2-1.1.4.tgz_1477320717465_0.056709148455411196"}}},"readme":"# ![weixin](http://weixin.qq.com/zh_CN/htmledition/images/favicon1fbcbe.ico)  Hubot-Weixin \n  - hubot [![hubot version](https://img.shields.io/npm/v/hubot.svg?style=plastic)](https://github.com/github/hubot) \n  - hubot-weixin [![hubot-weixin version](https://img.shields.io/npm/v/hubot-weixin.svg?style=plastic)](https://github.com/KasperDeng/Hubot-WeChat) \n  - npm [![npm version](https://img.shields.io/npm/v/npm.svg?style=plastic)](https://www.npmjs.com/package/hubot-weixin)\n  - nodejs [![node version](https://img.shields.io/node/v/latest-version.svg?style=plastic)](https://nodejs.org/en/)\n\n* [中文版](https://github.com/KasperDeng/Hubot-WeChat/blob/master/README-zh.md)\n* This is wechat/weixin adapter for hubot.\n* Notation: wechat is another name for the popular App weixin in China\n* Goal\n  - login once, run anywhere, anytime\n  - Make life easier and let bot do something for us in backend\n\n## Features of Hubot-WeChat (WeChat Adapter) ##\n* Basic functions as that in WeChat Web\n  - Auto-reply text to group\n  - Auto-reply media to group\n  - Auto-reply to specific person\n* Auto-report status to maintainer\n* A forever script to launch the hubot instance and mornintoring\n* Aboundants of scripts for hubot\n  - integrated with jenkins\n  - integrated with [turing robot](http://www.tuling123.com/)\n  - Lots of life information by querying the APIs provided from baidu api-store\n\n## Wechat Adapter Configuration ##\n\n### Basic Config ###\n* The hubot needs a real WeChatID\n* The hubot's WeChatID should be include in the group to be listened on for auto-reply\n* The group/specific person should be save into that contact list\n\n### config.yaml ###\n* A config.yaml is provided to set the configuration items \n  - Those items most are for wechat login in Hubot-WeChat startup\n\n* Get config items method\n  - Login the wechat from browser, use the wechatId which is used for hubot\n  - **Capture data from webwxinit api from browser debug mode**\n\n* url\n  - baseUrl -- wx/wx2\n  - baseUploadUrl -- file/file2\n  - Wechat server has traffic distribution to WX/WX2 server dependent on hubot's WeChat ID \n\n* Below data are needed and set into config.yaml apporiated fields \n  - header\n    + cookie\n  - BaseRequest\n    + Uin\n    + Sid\n    + Skey\n    + DeviceId\n\n* maintainerName\n  - Please fill the maintainer's wechat name (the maintainer should be in hubot's wechat contact list) \n  - Hubot will report its online status to maintainer in a configured interval\n\n* webWxSyncInterval\n  - To sync receiving message from WX server\n  - Default: 1500 ms \n\n* syncCheckInterval\n  - It is the heartbeat to WX server \n  - To trick WX server the login persion still on the web wechat\n  - Default: 30s, it is same behavior in web wechat\n\n* listenOnAllGroups\n  - default value: true. Then hubot will listen on all the group where it is in\n\n* listenGroupNameList\n  - It is used to control hubot only listen on some group for auto reply \n\n* Other config item: it's simple to know from its meaning and you can check the code for its usage\n\n## Start Up ##\n\n### by docker ###\n* `docker pull kasperdeng/hubot-weixin`\n  - size 83M, based on alpine linux\n* Please prepare below config files on host\n  - config.yaml with your login info: cookie, Uin, SKey, deviceId\n    + For starting in docker, please set `logToFile: true` and `wxLogPath: \"/root/hubot/wxhubot.log\"`\n    + e.g. `/home/kasper/dockerHubot/config.yaml`\n  - Your scripts directory\n    + e.g. `/home/kasper/dockerHubot/scripts`\n* start-up command. Please note using `-v`(volume) to map your config file and log file path on your host.\n  - `docker run -d -v /home/kasper/dockerHubot/scripts:/root/hubot/scripts -v /home/kasper/dockerHubot/config.yaml:/root/hubot/node_modules/hubot-weixin/config.yaml -v /home/kasper/dockerHubot/wxhubot.log:/root/hubot/wxhubot.log kasperdeng/hubot-weixin`\n  - Use this command to enter the docker instance for debugging. `docker run -it -v /home/kasper/dockerHubot/scripts:/root/hubot/scripts -v /home/kasper/dockerHubot/config.yaml:/root/hubot/node_modules/hubot-weixin/config.yaml -v /home/kasper/dockerHubot/wxhubot.log:/root/hubot/wxhubot.log kasperdeng/hubot-weixin /bin/sh`\n* About the image `kasperdeng/hubot-weixin`, please refer to [Dockfile](https://www.github.com/kasperdeng/docker-hubot-weixin)\n\n### by npm ###\n* First, setup hubot(details in [Hubot official](https://hubot.github.com))\n* add `hubot-weixin`to hubot's package.json\n* run `npm install` in your hubot dir\n* start hubot: `bin/hubot -a weixin`\n\n### by git pulling ###\n* Pull hubot-weixin from here\n* Make symbolic link to your hubot-weixin in Hubot'snode_modules\n  - `npm link <your hubot-weixin dir>`\n* start hubot: `bin/hubot -a weixin`\n\n\n## Design & Implementation Notes ##\n* The problem\n  - Scanning the QR code to login web wechat\n  - No published official WeChat api interface\n* Workaround for login\n  - Need login manually by scanning the QR code once\n  - Capture all the required data as hubot configuration(details in next slide) \n* Shoot the trouble\n  - Use chrome/firefox to analyze web WeChat API\n  - Try its web APIs by curl\n  - Analyze the parameters and what it is\n  - Analyze the wxApp.js\n* Notes:\n  - **The hubot wechat on the mobile side keeps online is preferred**\n  - Reason: WeChat server disconnects your hubot with websync failure after 3~4 days. \n    But hubot works again once login mobile wechat app again.\n\n## The Adapter Software Hierachy ##\n* Operations in our Wechat-Hubot\n  - wxbot.coffee\n\t\n* The coffeescript version's WxChat Web APIs\n  - wxApi.coffee\n\n* The http layer, including sync and async\n  - httpclient.coffee\n\n## Integrate Adapter to Hubot ##\n* Implement the needed methods of adapter\n  - constructor\n    + Getting the hubot robot \n  - send\n    + hubot sends out message to specific persion/group\n  - reply \n    + hubot replies message to specific persion/group\n  - run\n    + New a WxBot\n    + Being called in hubot launching\n      It is used to init the wechat groups information\n    + Integrate to Hubot by calling\n\n    ~~~\n    @emit 'connected'\n    ~~~\n* Implement a callback to call hubot's receive method to get the incoming message\n\n## SDE ##\n* [Getting Started With Hubot](https://hubot.github.com/docs/) on Windows/Unix-Like\n* Backlog management\n  - [kanbanflow](https://kanbanflow.com/board/23ec47145de7783b8cf2e80187538b5b)\n* Version control\n  - git \n* IDE\n  - Sublime\n  - or WebStorm/Vim\n* DevEnv\n  - Nodejs and npm\n  - Use `npm install` to get all the node modules\n    + Inside greatwall, add option `--registry=https://registry.npm.taobao.org`\n* Programming Language\n  - coffeeScript\n  - coffeelint to checkstyle \n\n## How to write Your Scripts? ##\n* Please refer to the scirpts in repo\n* Follow the coding style\n* The `msg` in the scripts provides the http asycn function to get your data from open APIs\n\n## Test Your Script ##\n* With shell adapter\n* Use your WeChat ID to test\n\n## Contributor ##\n* bumblebee team \n  - [Jeff Zhu](https://github.com/kfchu)\n  - [Yinsong Ma](https://github.com/eyinsma)\n  - [Kasper Deng](https://github.com/kasperdeng)\n\n* [Shouxi Huang](https://github.com/hsx1612727380)\n\n## TODO ##\n* No much functions to be implemented, most are focus on scripting\n* Unit test\n\n## Reference ##\n* [Hubot Official](https://hubot.github.com)\n* [About WxChat Web API](https://github.com/hexcola/wxplugin/blob/master/protocal_2.md)\n* [How to write your adapter?](https://hubot.github.com/docs/adapters/development/)\n\n## License ##\n* See the [LICENSE](https://github.com/KasperDeng/Hubot-WeChat/blob/master/LICENSE) file for license rights and limitations (MIT).\n\n","maintainers":[{"name":"xxlv","email":"lvxiang119@gmail.com"}],"time":{"modified":"2016-11-19T04:51:26.242Z","created":"2016-10-24T10:37:14.770Z","1.0.8":"2016-10-24T10:37:14.770Z","1.0.9":"2016-10-24T10:56:53.169Z","1.1.0":"2016-10-24T11:18:35.835Z","1.1.1":"2016-10-24T11:31:07.713Z","1.1.2":"2016-10-24T11:34:56.242Z","1.1.3":"2016-10-24T12:03:13.102Z","1.1.4":"2016-10-24T14:51:59.739Z"},"keywords":["hubot","adapter","wechat","weixin"],"author":{"name":"Kasper Deng","email":"kasperdeng@gmail.com"},"license":"MIT","readmeFilename":"README.md","users":{"dofy":true}}
